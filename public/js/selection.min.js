!function(){function a(a,b){return a.top===b.top&&a.bottom===b.bottom&&a.left===b.left&&a.right===b.right?!0:!1}var b,c={top:0,bottom:0,left:0,right:0,again:0},d=function(b){var d=window.getSelection&&window.getSelection();if(d&&d.rangeCount>0){var g=trim(d.toString()),h=d.getRangeAt(0).getBoundingClientRect();if(a(h,c)&&c.again)return void(c.again=0);if(""===g||!/^[^\u4e00-\u9fa5]+$/.test(g))return;for(var i=document.documentElement.querySelectorAll(".ChaZD-result-container"),j=0,k=i.length;k>j;j++)if(i[j].getAttribute("data-text").toLowerCase()===g.toLowerCase())return;chrome.storage.sync.set({currentWord:g},function(){});for(var l in c)"again"==l?c[l]=1:c[l]=h[l];"side"===currentSettings.showPosition&&e(g,currentSettings.useHttps),"near"===currentSettings.showPosition&&f(g,currentSettings.useHttps,h,b)}},e=function(a,c){var d=h(a,c);d.classList.add("ChaZD-result-side"),document.documentElement.appendChild(d),currentSettings.autoHide&&(b=setTimeout(function(){document.querySelector(".ChaZD-result-container")&&document.documentElement.removeChild(d)},1e3*currentSettings.showDuration))},f=function(a,c,d,e){var f=h(a,c),i=g();document.documentElement.appendChild(f),document.documentElement.appendChild(i);var j={};0===d.left&&0===d.top&&(d={left:e.clientX,top:e.clientY,height:15});var k=f.offsetWidth,l=d.right-d.left,m=d.left+window.pageXOffset,n=d.top+window.pageYOffset,o=l/2+m,p=m-(k-l)/2,q=o-12;p<window.pageXOffset?p=window.pageXOffset:p+k>window.pageXOffset+document.documentElement.clientWidth&&(p=window.pageXOffset+document.documentElement.clientWidth-k);var r=0;if(r=document.documentElement.clientHeight>document.body.clientHeight?document.body.clientHeight:document.documentElement.clientHeight,0===r&&(r=document.documentElement.clientHeight),d.top>=150){var s=r-n+10,t=s+1;j={left:p,bottom:s,arrowLeft:q,arrowBottom:t}}else j={left:p,top:n+d.height+12,arrowLeft:q,arrowTop:n+d.height+1};f.style.left=j.left+"px",i.style.left=j.arrowLeft+"px";var u,v,w=document.querySelectorAll(".ChaZD-arrow-outer"),x=document.querySelectorAll(".ChaZD-arrow-inner");if(j.bottom)for(f.style.bottom=j.bottom+"px",i.style.bottom=j.arrowBottom+"px",u=0,v=w.length;v>u;u++)w[u].classList.add("ChaZD-arrow-outer-down"),x[u].classList.add("ChaZD-arrow-inner-down");if(j.top)for(f.style.top=j.top+"px",i.style.top=j.arrowTop+"px",u=0,v=w.length;v>u;u++)w[u].classList.add("ChaZD-arrow-outer-up"),x[u].classList.add("ChaZD-arrow-inner-up");currentSettings.autoHide&&(b=setTimeout(function(){document.querySelector(".ChaZD-result-container")&&document.querySelector(".ChaZD-arrow-main")&&(document.documentElement.removeChild(f),document.documentElement.removeChild(i))},1e3*currentSettings.showDuration))},g=function(){var a=document.createElement("div");a.classList.add("ChaZD-arrow-main");var b=document.createElement("div");b.setAttribute("class","ChaZD-arrow-outer");var c=document.createElement("div");return c.setAttribute("class","ChaZD-arrow-inner"),a.appendChild(b),a.appendChild(c),a},h=function(a,b){var c=document.createElement("div");c.classList.add("ChaZD-result-container"),c.setAttribute("data-text",a);var d=document.createElement("div");return d.setAttribute("id","ChaZD-searching"),d.innerHTML="ψ(._. )>划词君正在翻译。。。",c.appendChild(d),chrome.runtime.sendMessage({queryWord:a,source:"select"},function(a){var b=a;if(d.innerHTML="",0===b.Code){c.innerHTML=b.titleBlock;var e=c.querySelector(".voice-container"),f=function(a){var b=a.getAttribute("data-src"),c=document.createElement("audio");currentSettings.defaultVoice&&(b+="&type="+currentSettings.defaultVoice),c.setAttribute("src",b),a.appendChild(c),currentSettings.autoAudio===!0&&c.play(),c.addEventListener("ended",function(a){this.load()}),a.addEventListener("click",function(a){c.play()})};f(e);var g=document.createElement("div");b.basicBlock?(g.innerHTML=b.basicBlock,c.appendChild(g)):b.haveTranslation?c.querySelector(".title-translation").style.display="block":b.haveWebTranslation?(g.innerHTML=b.webBlock,c.appendChild(g),c.querySelector(".web-title").innerHTML="网络释义"):c.innerHTML="╮(╯▽╰)╭划词君无能为力啊<br> 还是右键问问谷歌君吧=>"}else 20==b.Code?c.innerHTML="<p>这段文字太长，词典君无能为力了（┬_┬） <br><br>试试短一点的吧~</p>":40==b.Code?c.innerHTML="<p>对不起，这段文字太高深了，请饶过词典君吧（┬_┬）</p>":c.innerHTML="<p>词典君罢工啦（┬_┬）<br><br> 是不是网络不太好？<br><br> 稍后再试一次吧</p>"}),c},i=["ChaZD-result-container","title-container","title-word","title-translation","basic-container","phonetic-container","explains-container","explains-container","explains-list","property-container","explains-item","voice-container","us-phonetic-container","uk-phonetic-container","web-explains-container","web-explains-list","web-key","explains-item-value","web-value"];document.documentElement.addEventListener("mousedown",function(a){for(var c in i)if(a.target.classList.contains(i[c]))return;clearTimeout(b);var d,e,f=document.querySelectorAll(".ChaZD-result-container"),g=document.querySelectorAll(".ChaZD-arrow-main");if(f)for(d=0,e=f.length;e>d;d++)document.documentElement.removeChild(f[d]);if(g)for(d=0,e=g.length;e>d;d++)document.documentElement.removeChild(g[d]);chrome.storage.sync.set({currentWord:""})}),window.addEventListener("resize",function(a){var b=document.querySelector(".ChaZD-result-container"),c=document.querySelector(".ChaZD-arrow-main");b&&document.documentElement.removeChild(b),c&&document.documentElement.removeChild(c)});var j=function(a){if("noSelect"!==currentSettings.selectMode){if("useCtrl"===currentSettings.selectMode)if("ctrl"===currentSettings.toggleKey){if(!a.ctrlKey&&!a.metaKey)return void(c.again=0)}else if("alt"===currentSettings.toggleKey){if(!a.altKey)return void(c.again=0)}else if("shift"===currentSettings.toggleKey&&!a.shiftKey)return void(c.again=0);d(a)}},k=null,l=function(a){currentSettings.linkQuery&&(k=a.target,a.shiftKey&&n(a))},m=function(a){currentSettings.linkQuery&&(k&&k.classList.contains("ChaZD-link")&&o(a,!0),k=null)},n=function(a){k&&a.shiftKey&&(p(a),k.setAttribute("ChaZD-href",k.getAttribute("href")),k.removeAttribute("href"),k.classList.add("ChaZD-link"))},o=function(a,b){k&&(b||16==a.keyCode)&&(k.setAttribute("href",k.getAttribute("ChaZD-href")),k.removeAttribute("ChaZD-href"),k.classList.remove("ChaZD-link"))},p=function(a){currentSettings.linkQuery&&a.shiftKey&&window.getSelection().empty()};document.documentElement.addEventListener("mouseup",j),document.documentElement.addEventListener("mouseover",function(a){("A"===a.target.nodeName||"a"===a.target.nodeName)&&l(a)}),document.documentElement.addEventListener("mouseout",function(a){("A"===a.target.nodeName||"a"===a.target.nodeName)&&m(a)}),document.documentElement.addEventListener("keydown",n),document.documentElement.addEventListener("keyup",o),document.documentElement.addEventListener("selectstart",j)}();